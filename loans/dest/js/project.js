/*!
 * LastModifyTime: 2017-04-12 10:08:26
 * Copyright(c) 2017 H5项目管理
 */
var proInfo={currentPage:1,keyWord:$("input[name=search]").val(),getList:function(e){var t=getUrlParam({name:"projectType"}),a=e?e:this;$(".self-tips").remove(),$(".ui-loading-wrap").removeClass("none").html(message.loading),"s"==a.type&&(a.currentPage=1),$.ajax({type:"post",url:url+"/projectInfo/list",data:{pageNum:a.currentPage,projectType:t,keyWord:a.keyWord},success:function(e){if(a.type="",0==e.code){var t=e.dataSource,n=template("proInfoList",t);1==a.currentPage?$(".proInfoList").html(n):$(".proInfoList").append(n),0==t.totalPage?($(".ui-loading-wrap").addClass("none"),tips({classname:"tips-no-message",content:message.noMssege,divBox:".loan-list"})):t.totalPage<=a.currentPage&&$(".ui-loading-wrap").html(message.success),a.currentPage++}else $.tips({content:e.msg,stayTime:3e3}),999001==e.code&&setTimeout(function(){window.location.href="login.html"},1e3)},error:function(){$.tips({content:message.serverErr,stayTime:3e3})}})},init:function(){var e=getUrlParam({name:"keyWord",type:"decode"});""!=e&&($("input[name=search]").val(e),this.keyWord=e),this.callback=this.getList,this.getList(),search.init(this),scrollFunc(this)}},proInfoDetail={getInfo:function(){var e={projectNo:getUrlParam({name:"projectNo"})};$.ajax({type:"post",url:url+"/projectInfo/details",data:e,success:function(e){if(0==e.code){var t=template("proInfoTemp",e);$("#proInfo").html(t)}else $.tips({content:e.msg,stayTime:3e3}),999001==e.code&&setTimeout(function(){window.location.href="login.html"},1e3)},error:function(){$.tips({content:message.serverErr,stayTime:3e3})}})},init:function(){this.getInfo()}},proPlay={currentPage:1,keyWord:$("input[name=search]").val(),getList:function(e){var t=e?e:this,a=getUrlParam({name:"projectNo"});null!=a&&$(".loan-search").addClass("none"),$(".self-tips").remove(),$(".ui-loading-wrap").removeClass("none").html(message.loading),"s"==t.type&&(t.currentPage=1),$.ajax({type:"post",url:url+"/projectPlan/list",data:{pageNum:t.currentPage,keyWord:t.keyWord,projectNo:a},success:function(e){if(t.type="",0==e.code){var a=e.dataSource,n=template("proPlayList",a);1==t.currentPage?$(".loan-list").html(n):$(".loan-list").append(n),0==a.totalPage?($(".ui-loading-wrap").addClass("none"),tips({classname:"tips-no-message",content:message.noMssege,divBox:".loan-list"})):a.totalPage<=t.currentPage&&$(".ui-loading-wrap").html(message.success),t.currentPage++}else $.tips({content:e.msg,stayTime:3e3}),999001==e.code&&setTimeout(function(){window.location.href="login.html"},1e3)},error:function(){$.tips({content:message.serverErr,stayTime:3e3})}})},init:function(){var e=getUrlParam({name:"keyWord",type:"decode"});""!=e&&($("input[name=search]").val(e),this.keyWord=e),this.callback=this.getList,search.init(this),this.getList(),scrollFunc(this)}},proPlayDetail={getInfo:function(){var e=getUrlParam({name:"planNo"});$.ajax({type:"post",url:url+"/projectPlan/details",data:{planNo:e},success:function(e){if(0==e.code){var t=template("proPlayListTemp",e);$("#pro_play_list").html(t)}else $.tips({content:e.msg,stayTime:3e3}),999001==e.code&&setTimeout(function(){window.location.href="login.html"},1e3)},error:function(){tips({classname:"tips-no-message",content:message.noMssege,divBox:".loan-list"})}})},init:function(){this.getInfo()}},proPlan={currentPage:1,keyWord:$("input[name=search]").val(),getList:function(e){var t=e?e:this,a=getUrlParam({name:"projectNo"});null!=a&&$(".loan-search").addClass("none"),$(".self-tips").remove(),$(".ui-loading-wrap").removeClass("none").html(message.loading),"s"==t.type&&(t.currentPage=1),$.ajax({type:"post",url:url+"/planSchedule/list",data:{pageNum:t.currentPage,keyWord:t.keyWord,projectNo:a},success:function(e){if(t.type="",0==e.code){var a=e.dataSource,n=template("proPlanTemp",a);1==t.currentPage?$(".loan-list").html(n):$(".loan-list").append(n),0==a.totalPage?($(".ui-loading-wrap").addClass("none"),tips({classname:"tips-no-message",content:message.noMssege,divBox:".loan-list"})):a.totalPage<=t.currentPage&&$(".ui-loading-wrap").html(message.success),t.currentPage++}else $.tips({content:e.msg,stayTime:3e3}),999001==e.code&&setTimeout(function(){window.location.href="login.html"},1e3)},error:function(){$.tips({content:message.serverErr,stayTime:3e3})}})},init:function(){var e=getUrlParam({name:"keyWord",type:"decode"});""!=e&&($("input[name=search]").val(e),this.keyWord=e),this.callback=this.getList,this.getList(),search.init(this),scrollFunc(this)}},proPlanDetail={getInfo:function(){var e={scheduleNo:getUrlParam({name:"scheduleNo"}),planNo:getUrlParam({name:"planNo"})};$.ajax({type:"post",url:url+"/planSchedule/details",data:e,success:function(e){if(0==e.code){var t=template("planlistTemp",e);$("#proPlanList").html(t)}else $.tips({content:e.msg,stayTime:3e3}),999001==e.code&&setTimeout(function(){window.location.href="login.html"},1e3)},error:function(){$.tips({content:message.serverErr,stayTime:3e3})}})},init:function(){this.getInfo()}},proPlayContent={currentPage:1,getList:function(e){var t=e?e:this,a=getUrlParam({name:"scheduleNo"});$(".self-tips").remove(),$(".ui-loading-wrap").removeClass("none").html(message.loading),$.ajax({type:"post",url:url+"/planSchedule/contents",data:{scheduleNo:a,pageNum:t.currentPage},success:function(e){if(0==e.code){var a=e.dataSource,n=template("proPlanContentTemp",a);1==t.currentPage?$(".pro-content-list").html(n):$(".pro-content-list").append(n),0==a.totalPage?($(".ui-loading-wrap").addClass("none"),tips({classname:"tips-no-message",content:message.noMssege,divBox:".pro-content-list"})):a.totalPage<=t.currentPage&&$(".ui-loading-wrap").html(message.success),t.currentPage++}else $.tips({content:e.msg,stayTime:3e3}),999001==e.code&&setTimeout(function(){window.location.href="login.html"},1e3)},error:function(){$.tips({content:message.serverErr,stayTime:3e3})}})},init:function(){this.callback=this.getList,this.getList(),scrollFunc(this)}},proReport={currentPage:1,keyWord:$("input[name=search]").val(),getList:function(e){var t=e?e:this;$(".self-tips").remove(),$(".ui-loading-wrap").removeClass("none").html(message.loading),"s"==t.type&&(t.currentPage=1),$.ajax({type:"post",url:url+"/projectReport/list",data:{pageNum:t.currentPage,keyWord:t.keyWord},success:function(e){if(t.type="",0==e.code){var a=e.dataSource,n=template("proReportTemp",a);1==t.currentPage?$(".loan-list").html(n):$(".loan-list").append(n),0==a.totalPage?($(".ui-loading-wrap").addClass("none"),tips({classname:"tips-no-message",content:message.noMssege,divBox:".pro-content-list"})):a.totalPage<=t.currentPage&&$(".ui-loading-wrap").html(message.success),t.currentPage++}else $.tips({content:e.msg,stayTime:3e3}),999001==e.code&&setTimeout(function(){window.location.href="login.html"},1e3)},error:function(){$.tips({content:message.serverErr,stayTime:3e3})}})},init:function(){var e=getUrlParam({name:"keyWord",type:"decode"});""!=e&&($("input[name=search]").val(e),this.keyWord=e),this.callback=this.getList,search.init(this),this.getList(),scrollFunc(this)}},proReportDetail={getInfo:function(){var e=getUrlParam({name:"projectNo"});$.ajax({type:"post",url:url+"/projectReport/details",data:{projectNo:e},success:function(e){if(0==e.code){var t=template("proReportListTemp",e);$("#proReportList").html(t)}else $.tips({content:e.msg,stayTime:3e3}),999001==e.code&&setTimeout(function(){window.location.href="login.html"},1e3)},error:function(){$.tips({content:message.serverErr,stayTime:3e3})}})},init:function(){this.getInfo()}},gantt={currentPage:1,totalPage:100,getList:function(e,t){var a,n,o=getUrlParam({name:"projectNo"}),s=getUrlParam({name:"flag"}),r=this.currentPage;"0"==e?(r--,this.currentPage=r):1==e&&(r++,this.currentPage=r),t&&t.length>0&&(a=t[0],n=t[1]),$.ajax({type:"post",url:url+"/projectReport/ganttChart",data:{pageNum:r,projectNo:o,year:a,month:n},success:function(t){if(0==t.code){var a=t.dataSource;if(this.totalPage=a.totalPage,0==this.totalPage)return $("#gantt").html(""),tips({classname:"tips-no-message",content:message.noMssege}),!1;if(1==this.totalPage?$(".gantt-pages").addClass("none"):1==r?($(".gantt-page-pre").addClass("none"),$(".gantt-page-next").removeClass("none")):r==this.totalPage?($(".gantt-page-pre").removeClass("none"),$(".gantt-page-next").addClass("none")):($(".gantt-page-pre").removeClass("none"),$(".gantt-page-next").removeClass("none")),e!=-1){var n=template("ganttTemp",a);$("#gantt-list").html(n)}var o=template("ganttDayPicTemp",a);$(".gantt-pic .ui-table").html(o);var i=$(".gantt-head-icon");i.hasClass("active")?($(".gantt-week-list").addClass("none"),$(".gantt-day-list").removeClass("none")):($(".gantt-week-list").removeClass("none"),$(".gantt-day-list").addClass("none")),r++,this.currentPage=r}else if($.tips({content:t.msg,stayTime:3e3}),999001==t.code){if("app"==s)return window.app.goLogin(),!1;setTimeout(function(){window.location.href="login.html"},1e3)}},error:function(){$.tips({content:message.serverErr,stayTime:3e3})}})},getPageList:function(){var e=this;$(".gantt-pages").on("click",".gantt-page",function(){var t=$(this),a=t.data("type"),n=$(".cur-month").data("date"),o=[];o=n.split("-"),e.getList(a,o),document.documentElement.scrollTop=document.body.scrollTop=0})},choosePro:function(){var e=this;$(document).on("click",".gantt-project",function(){var t=$(this),a=t.data("date"),n=[];n=a.split("-"),$(".cur-month").html(n[1]+"月"),e.getList("-1",n),$(".cur-month").attr("data-date",a),t.addClass("active").siblings().removeClass("active")})},todayFun:function(){var e=this;$(document).on("click",".gantt-today",function(){var t=new Date,a=t.getFullYear(),n=t.getMonth()+1,o=[a,n];$(".cur-month").html(n+"月"),$(".cur-month").attr("data-date",a+"-"+n),e.getList("-1",o)})},changeWeek:function(){$(document).on("click",".gantt-head-icon",function(){var e=$(this);e.hasClass("active")?(e.removeClass("active"),$(".gantt-week-list").removeClass("none"),$(".gantt-day-list").addClass("none")):(e.addClass("active"),$(".gantt-week-list").addClass("none"),$(".gantt-day-list").removeClass("none"))})},chooseMonth:function(){var e=this,t=new Date,a=t.getFullYear(),n=t.getMonth()+1,o=[],s=[],r=[];$(".cur-month").html(n+"月"),o=[a-1,a,a+1],s=["01","02","03","04","05","06","07","08","09","10","11","12"];for(var i=0;i<o.length;i++)for(var l=0;l<s.length;l++){var c=o[i]+"-"+s[l];r.push(c)}var g=n>10?n:"0"+n,u=a+"-"+g;$(".cur-month").attr("data-date",u);var m=new WheelPicker({data:[r],value:[u],onSelect:function(t){var a=[];a=t[0].value.split("-"),$(".cur-month").html(a[1]+"月"),e.getList("-1",a),$(".cur-month").attr("data-date",t[0].value)}});$(document).on("click",".cur-month",function(){return m.show(),!1})},init:function(){this.getList(),this.getPageList(),this.choosePro(),this.todayFun(),this.changeWeek(),this.chooseMonth()}},proLog={currentPage:1,setTitle:{Contract:function(){return"合同日志"},PaymentPlan:function(){return"还款计划日志"},Clause:function(){return"条款日志"},Node:function(){return"节点日志"},NodeReport:function(){return"汇报日志"},Debtor:function(){return"借款公司日志"},Lender:function(){return"贷款人日志"},Guarantee:function(){return"担保日志"}},getList:function(e){var t=e?e:this;$(".self-tips").remove(),$(".ui-loading-wrap").removeClass("none").html(message.loading);this.currentPage;$.ajax({type:"post",url:url+"/loanOperationLog/list",data:{pageNum:t.currentPage,relatedCategory:t.relatedCategory},success:function(e){if(0==e.code){var a=e.dataSource,n=template("proLogTemp",a);1==t.currentPage?$(".log-list").html(n):$(".log-list").append(n),0==a.totalPage?($(".ui-loading-wrap").addClass("none"),tips({classname:"tips-no-message",content:message.noMssege,divBox:".log-list"})):a.totalPage<=t.currentPage&&$(".ui-loading-wrap").html(message.success),$(".log-pro-detail>div").each(function(){var e=$(this).height(),t=$(this).parent(".log-pro-detail").height();e>t&&($(this).addClass("box"),$(this).parent().children(".more").removeClass("none"))}),t.currentPage++}else $.tips({content:e.msg,stayTime:3e3}),999001==e.code&&setTimeout(function(){window.location.href="login.html"},1e3)},error:function(){$.tips({content:message.serverErr,stayTime:3e3})}})},getMore:function(){$(document).on("click",".log-pro-detail .more",function(){var e=$(this).parents(".log-pro-detail ").children(".log_more_content").html();$(".pro_log_dialog .ui-dialog-bd").html(e);$(".ui-dialog").dialog("show")})},init:function(){this.relatedCategory=getUrlParam({name:"relatedCategory"}),document.title=this.setTitle[this.relatedCategory](),this.getList(this),this.getMore(),this.callback=this.getList,scrollFunc(this)}};